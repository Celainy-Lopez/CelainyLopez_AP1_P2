@inject ToastService Toast
<Toasts class="p-3" AutoHide="true" Delay="4000" Placement="ToastsPlacement.TopRight" />
<div class="col-auto input-group align-items-center">

    @*Articulos*@
    <InputSelect class="form-control form-select" @bind-Value="ArticuloId">
        <option value="0" selected disabled>-- Seleccione un articulo --</option>
        @foreach (var articulo in ListArticulos)
        {
            <option value="@articulo.ArticuloId"> @articulo.ArticuloId -- @articulo.Descripcion -- (@articulo.Existencia) -- ($@articulo.Precio.ToString("N2"))</option>
        }
    </InputSelect>

    @*Cantidad*@
    <label class="col-form-label input-group-text">Cantidad </label>
    <InputNumber class="form-control" @bind-Value="Cantidad" placeholder="$0.00"></InputNumber>

    @*Precio*@
    <label class="col-form-label input-group-text">Costo</label>
    <InputNumber class="form-control" @bind-Value="Precio" placeholder="0.00$" readonly></InputNumber>
    <button type="button" class="btn btn-outline-success bi bi-plus" @onclick="BuscarCantidad" >Agregar detalle</button>

 </div>

@code
{

    [Parameter]
    public List<Productos> ListArticulos { get; set; } = [];

    [Parameter]
    public EventCallback<(Productos Articulos, int Cantidad)> ArticuloSeleccionado { get; set; }

    [Parameter]
    public int ArticuloId { get; set; }

    [Parameter]
    public double Precio { get; set; }

    [Parameter]
    public int Cantidad { get; set; }


    public async Task BuscarCantidad()
    {
        if (ArticuloId > 0)
        {
            var articulo = ListArticulos.Single(p => p.ArticuloId == ArticuloId);
            if(Cantidad <= 0)
            {
                Toast.Notify(new(ToastType.Danger, "La cantidad debe ser mayor que 0."));
                return;
            }
            await ArticuloSeleccionado.InvokeAsync((articulo, Cantidad));
        }
        else
        {
            Toast.Notify(new(ToastType.Danger, "Seleccione un articulo."));
            return;
        }
    }
}

